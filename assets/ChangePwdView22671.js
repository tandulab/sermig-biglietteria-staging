import{d as b,u as g,a as v,c as C,_ as L,r,b as y,e as P,f as e,w as u,g as p}from"../index22671.js";import{c as x,a as _,b as V,L as $}from"./index.esm22671.js";import{F as S}from"./vee-validate.esm22671.js";import{P as B}from"./PasswordWithValidation22671.js";import{u as F,s as k,e as f}from"./helpers22671.js";const U=b({name:"ChangePwdView",setup(){const a=g(),s=v(),{showLoader:l,hideLoader:t}=F(),w=x({password:_().required("La password è obbligatoria").min(8,"La password deve essere di almeno 8 caratteri"),password_confirmation:_().oneOf([V("password")],"Le password devono corrispondere").required("La conferma password è obbligatoria")}),n=C(()=>a.user),m=async function(o,c){l();const d={id:n.value.id,user:{password_confirmation:o.password_confirmation,password:o.password}};await a.changePassword(d).then(async()=>{k(s,{message:"Password aggiornata correttamente",error:!1}),t(),i()}).catch(h=>{t(),f(s,h)})};async function i(){const o={email:n.value.email,password:n.value.password};await a.login(o).then(async()=>{t()}).catch(c=>{t(),f(s,c)})}return{schema:w,currentUser:n,onSubmit:m}},components:{Logo:$,PasswordWithValidation:B,Form:S}});const W={class:"flex justify-content-center align-items-center mt-4 sm:h-screen sm:mt-0 login"},q={class:"m-2 text-center"};function N(a,s,l,t,w,n){const m=r("Logo"),i=r("PasswordWithValidation"),o=r("Button"),c=r("Form"),d=r("Card");return y(),P("div",W,[e(d,{class:"py-4 px-3"},{content:u(()=>[p("div",q,[e(m)]),s[0]||(s[0]=p("h1",{class:"mb-3 mt-0 text-center"},"Cambia la password",-1)),s[1]||(s[1]=p("p",{class:"font-normal mb-4"},"Inserisci una nuova password di minimo 8 caratteri",-1)),e(c,{"validation-schema":a.schema,onSubmit:a.onSubmit,class:"flex flex-column"},{default:u(()=>[e(i,{name:"password",label:"Password*",type:"password"}),e(i,{name:"password_confirmation",label:"Conferma password*",type:"password"}),e(o,{label:"Conferma password",type:"submit",class:"mt-5 mb-3"})]),_:1},8,["validation-schema","onSubmit"])]),_:1})])}const O=L(U,[["render",N]]);export{O as default};
